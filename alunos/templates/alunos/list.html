{% extends 'base.html' %}

{% block content %}
<h1>Alunos</h1>

<div class="actions">
    <a href="{% url 'aluno_create' %}" class="btn btn-primary">
        Adicionar Aluno
    </a>
</div>

<form method="get" class="filters">
    <input
        type="text"
        name="search"
        placeholder="Buscar por nome"
        value="{{ request.GET.search }}"
    >

    <select name="sala">
        <option value="">Todas as salas</option>
        {% for sala in salas %}
            <option value="{{ sala.id }}" {% if sala.id|stringformat:"s" == request.GET.sala %}selected{% endif %}>
                {{ sala.nome }}
            </option>
        {% endfor %}
    </select>

    <select name="order">
        <option value="data_inclusao">Data de inclusão (crescente)</option>
        <option value="-data_inclusao">Data de inclusão (decrescente)</option>
        <option value="nome">Nome (crescente)</option>
        <option value="-nome">Nome (decrescente)</option>
        <option value="data_nascimento">Nascimento (crescente)</option>
        <option value="-data_nascimento">Nascimento (decrescente)</option>
        <option value="sala__nome">Sala (crescente)</option>
        <option value="-sala__nome">Sala (decrescente)</option>
    </select>

    <button type="submit" class="btn btn-primary">Filtrar</button>
</form>

<table>
    <thead>
        <tr>
            <th>Nome</th>
            <th>Nascimento</th>
            <th>Data inclusão</th>
            <th>Sala</th>
            <th>Ações</th>
        </tr>
    </thead>

    <tbody>
        {% for aluno in alunos %}
            <tr>
                <td>{{ aluno.nome }}</td>
                <td>{{ aluno.data_nascimento|date:"d/m/Y" }}</td>
                <td>{{ aluno.data_inclusao|date:"d/m/Y H:i" }}</td>
                <td>{{ aluno.sala.nome }}</td>
                <td class="table-actions">
                    <a href="{% url 'aluno_edit' aluno.id %}" class="btn btn-secondary btn-sm">
                        Editar
                    </a>

                    <a href="{% url 'aluno_delete' aluno.id %}" class="btn btn-danger btn-sm">
                        Remover
                    </a>
                </td>

            </tr>
        {% empty %}
            <tr>
                <td colspan="5">Nenhum aluno encontrado.</td>
            </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}